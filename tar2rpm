
# work in progress
updateandinstall(){
if [[ -d /etc/apt ]]; then
     sudo apt update  && sudo apt install -y rpm tar bash wget
elif [[ -d /etc/dnf ]]; then
     sudo dnf update -y && sudo dnf -y rpm-build tar bash wget 
if 
}
updateandinstall
if [[ ! -d "$HOME/rpmbuild" ]]; then
mkdir -p rpmbuild/{BUILD,SOURCES,BUILDROOT,RPMS,SOURCES,SPECS,SRPMS} 
if [[ -d "$HOME/rpmbuild" ]]; then
rm -rf ~/rpmbuild/BUILDROOT/* && rm -rf ~/rpmbuild/SOURCES/* && rm -rf ~/rpmbuild/BUILD/*
mkdir -p ~/rpmfiles && mv ~/rpmbuild/RPMS/* ~/rpmfiles
mkdir -p ~/srpmfiles && mv ~/rpmbuild/SRPMS/* ~/srpmfiles
dae(){

# Prompt for URL and validate
while true; do
    read -p "Enter the tar file URL: " TAR_URL
    [[ -z "$TAR_URL" || ! "$TAR_URL" =~ ^https?://[a-zA-Z0-9./_-]+$ ]] && echo "Invalid URL, try again." || break
done

# Download the tar file
TAR_FILE=$(basename "$TAR_URL")
DEST_FILE="$HOME/$TAR_FILE"
echo "Downloading $TAR_FILE..."
wget -q --show-progress -O "$DEST_FILE" "$TAR_URL" 

# Check download success
[[ ! -f "$DEST_FILE" ]] && echo "Download failed!" && exit 1

# Extract and cleanup
TAR_DIR=$(tar -xvf "$DEST_FILE" -C ~/ | cut -d / -f1 | uniq)
rm $DEST_FILE
clear

}

help(){
cat << EOF

tar2rpm is a bash script to convert a tarfile into a rpm file.

commands:
  --extract = extracts a tarfile (optional not recommended) ex: tar2rpm --extract ~/tar2rpm.tar.xz
  --dae = dae means upload and extract. output: Enter the tar file URL:
  --prompt = prompts the user so the user can customize the spec file how they like it.
  --metf   = metf stands for move extracted file, which moves the specifed tarfile to directory rpmbuild. ex: tar2rpm --metf ~/tar2deb-1.0.0.tar.xz
  --help|--h = displays this message ex: tar2rpm --help or --h

contact/accounts: 
  email: wg9797@outlook.com
  github: https://github.com/gitxpresso

EOF 
if [[ "$1" == "--metf" ]]; then
if [[ "$1" == "--prompt" ]]; then
   prompt
fi
if [[ "$1" == "--dae" ]]; then
    dae
fi

if [[ "$1" == "--h" || "$1" == "--help" ]]
   help
fi

if [[ "$1" == "--extract" ]]; then 
    tar -xvf $2 -C ~/rpmbuild/SOURCES
fi
